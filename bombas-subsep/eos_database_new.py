# -*- coding: utf-8 -*-
"""
Created on Mon Nov 11 15:49:34 2024

@author: rodri
"""

from eos_database import *
from casadi import *
from numpy import exp, log, array, roots, isnan, fromstring
from scipy.optimize import fsolve
from species_builder import R, Species, Mixture



A = [[-12.98,-1.7675,39.4889,30.903,67.721,64.25,63.198,74.513,71.41,126.507,0.00000000497872,0.00000000733469,0.00000000410848,0.0000000066763,0.0000000239668,0.00000000923742,0.0000000112262,0.000000000786434,-0.0000000074795,0.0000000128769,0.00000000682246,0.00000000524019,-32.5469,-36.375,-39.81,-43.481,-46.5289,2.888634,-5.7296,0.00000000125255],
     [2.36459,1.1429,0.395,0.1533,0.00854058,-0.131798,-0.0117017,-0.096697,-0.0968949,-0.2701,-0.0652895,-0.0556135,-0.0537062,-0.0547613,-0.0567345,-0.0553483,-0.0561178,-0.0575014,-0.0580973,-0.056861,-0.0576885,-0.07921,0.2843,0.2908,0.2963,0.303499,0.3086,0.9827466,1.9145,0.618139],
     [-0.00213247,-0.0003236,0.00211409,0.00263479,0.00327699,0.003541,0.0033164,0.00347649,0.003473,0.00399829,0.00340288,0.00337665,0.00337144,0.00337268,0.0033764,0.0033723,0.00337318,0.00337633,0.00337688,0.00337355,0.00337415,0.00343135,0.0028624,0.0028633,0.002864,0.00286449,0.0028654,0.00009714241,-0.00039574,0.000484485],
     [0.0000056618,0.0000042431,0.000000396486,0.0000000727226,-0.00000110968,-0.0000013332,-0.0000011705,-0.0000013212,-0.0000013302,-0.000001973,-0.00000125345,-0.00000123882,-0.00000123662,-0.00000124201,-0.00000124967,-0.00000124726,-0.00000125103,-0.00000125675,-0.00000125882,-0.00000125642,-0.00000126001,-0.0000013177,-0.000000706426,-0.000000707176,-0.000000707916,-0.000000708416,-0.000000709045,-0.0000000004157947,0.000000876206,-0.000000149353],
     [-0.00000000372476,-0.00000000339316,-0.000000000667176,-0.000000000727896,0.000000000176646,0.000000000251446,0.000000000199636,0.000000000252365,0.000000000255766,0.000000000622796,0.000000000200955,0.000000000198716,0.000000000197836,0.000000000199451,0.000000000202038,0.000000000201377,0.000000000202432,0.000000000204254,0.000000000205021,0.000000000204138,0.000000000205295,0.000000000223681,0,0,0,0,0,-0.000000000003655484,-0.000000000495055,0.000000000022905],
     [0.000000000000860896,0.000000000000882096,0.000000000000167936,0.000000000000236736,-6.39926E-15,-1.29576E-14,-8.66485E-15,-1.34666E-14,-1.37726E-14,-9.38135E-14,-2.23759E-23,-3.70139E-23,-2.08778E-23,-3.4102E-23,-1.34792E-22,-4.4377E-23,-6.29863E-23,-2.46365E-24,4.21753E-23,-6.96619E-23,-3.35504E-23,-2.72426E-23,0,0,0,0,0,4.050133E-16,0.000000000000103846,-1.37045E-15],
     [31.35,44.0103,52.3785,58.7845,66.945,66.7563,63.3315,70.4265,78.3285,86.997,111.977,123.136,121.162,125.191,14.1201,143.577,152.638,225.023,14.1361,14.1069,14.1381,196.75,133.88,147.4,212.92,204.51,152.24,35.4113,65.9278,133.62],
     [-1307.52,-2568.82,-3490.55,-4136.68,-4604.09,-5059.18,-5117.78,-6055.6,-6947,-7890.6,-9558.5,-10635.2,-11079.2,-11737,-3892.9,-13893.7,-14762.2,-18736.5,-4294.53,-4361.79,-4450.43,-19441,-17129,-18406,-21841,-21711,-19976,-966.243,-7227.53,-4735],
     [0,0,0,0,0,0,0,0,0,0,0,0,0,0,-98.93,0,0,0,-124,-129.899,-135.5,0,0,0,0,0,0,0,0,0],
     [-3.26134,-4.97635,-6.10875,-7.01666,-8.25491,-8.08935,-7.48305,-8.37865,-9.44866,-10.6255,-14.2702,-15.8051,-15.3772,-15.8737,0,-18.2992,-19.5485,-30.231,0,0,0,-25.525,-15.87,-17.694,-27.531,-26.255,-18.161,-4.31849,-7.17695,-21.267],
     [0.000029418,0.0000146447,0.0000111869,0.0000103662,0.0000115706,0.00000925395,0.00000776606,0.00000661666,0.00000647481,0.00000647441,0.00000846031,0.00000864176,0.00000759021,0.00000729968,0,0.00000736401,0.00000764105,0.0000138881,0,0,0,0.0000088382,3.5456E-18,3.9369E-18,0.0000084197,0.0000077485,3.0543E-18,0.000079319,0.0000040313,0.040908],
     [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,6,6,2,2,6,2,2,1],
     [16.0429000854492,30.0699005126953,44.0970001220703,58.1240005493164,58.1240005493164,72.1510009765625,72.1510009765625,86.1779022216797,100.205001831055,114.232002258301,128.259002685547,142.285003662109,156.313003540039,170.339004516602,184.367004394531,198.380004882813,212.410003662109,226.429000854492,240.457000732422,254.47900390625,268.510009765625,282.540008544922,296.5830078125,310.588012695313,324.609008789063,338.639007568359,352.670013427734,28.0130004882813,18.015100479126,44.0097007751465],
     [-161.525,-88.5999969482422,-42.1019958496094,-11.7299865722656,-0.501989746093727,27.8780151367188,36.0590148925781,68.7300048828125,98.4290100097656,125.670007324219,150.817010498047,174.149011230469,195.890008544922,216.278009033203,235.429010009766,253.508020019531,270.618005371094,286.790002441406,302.149011230469,316.709008789063,330.649011230469,343.779016113281,356.500024414063,368.610009765625,380.219018554688,391.279016113281,401.889001464844,-195.800199890137,99.9980102539063,-78.5519927978515],
     [299.394012451172,355.683013916016,506.678009033203,561.966003417969,583.223022460938,623.442016601563,629.72900390625,662.664001464844,686.815002441406,705.377014160156,720.247009277344,732.721008300781,742.846008300781,751.14501953125,758.814025878906,762.913024902344,770.405029296875,775.481018066406,780.192016601563,784.093017578125,787.591003417969,790.669006347656,794.302001953125,796.752014160156,799.906005859375,801.359008789063,803.414001464844,806.3740234375,997.986022949219,825.335021972656],
     [-82.4509948730469,32.2780090332031,96.7480102539063,134.946008300781,152.049005126953,187.248010253906,196.450006103516,234.748010253906,267.008020019531,295.448022460938,321.448022460938,344.448022460938,365.149011230469,385.149011230469,402.649011230469,420.85,433.85,443.85,460.219995117188,472.110009765625,482.779016113281,494.85,504.85,513.85,522.85,530.85,538.85,-146.955999755859,374.149011230469,30.9500061035156],
     [4640.68017578125,4883.85009765625,4256.66015625,3647.6201171875,3796.6201171875,3333.59008789063,3375.1201171875,3031.6201171875,2736.78002929688,2496.6201171875,2300.07006835938,2107.55004882813,1964.93005371094,1829.92004394531,1723.53002929688,1620.18005371094,1516.81005859375,1420.56005859375,1316.90002441406,1213.46997070313,1116.94995117188,1160,1110,1060,1020,980,950,3394.3701171875,22120,7370],
     [0.0989999026060104,0.148000001907349,0.200000002980232,0.263000011444092,0.254990011453629,0.30799001455307,0.310990005731583,0.368000000715256,0.425980001688004,0.486000001430511,0.542990028858185,0.601970016956329,0.660000026226044,0.712970018386841,0.779990017414093,0.829990029335022,0.879980027675629,0.939970016479492,1.00581002235413,1.07000005245209,1.12999999523163,1.19000005722046,1.24477005004883,1.30113005638123,1.35604000091553,1.41112005710602,1.46473002433777,0.0900000035762787,0.0571000017225742,0.0939000025391579],
     [0.0114984000101686,0.0986000001430511,0.152400001883507,0.184790000319481,0.20100000500679,0.222240000963211,0.253890007734299,0.300700008869171,0.349790006875992,0.401800006628036,0.445490002632141,0.488480001688004,0.535000026226044,0.561990022659302,0.623000025749207,0.679000020027161,0.705990016460419,0.764980018138885,0.769990026950836,0.800000011920929,0.827000021934509,0.906877994537354,0.942004024982452,0.972190022468567,1.02617001533508,1.07102000713348,1.105260014534,0.0399998016655445,0.34400001168251,0.238940000534058]]

critical_table = array(A)

Aij = [[0,0.00224137306213379,0.00682878494262695,0.0131134390830994,0.0123046040534973,0.017627477645874,0.0179253816604614,0.0234740376472473,0.0288642644882202,0.0341590642929077,0.0389260053634644,0.0436087250709534,0.0359990000724792,0.100000001490116,0.5,0.0479862093925476,0.0517986416816711,0.056393027305603,0.0596672892570496,0.0628201365470886,0.066456139087677,0.0702759027481079,0.0738418102264404,0.077045202255249,0.0801324844360352,0.0828560590744019,0.085570752620697,0.0881350636482239,0.0906322002410889,0.0929945111274719],
       [0.00224137306213379,0,0.00125795602798462,0.00457346439361572,0.0040963888168335,0.00741332769393921,0.00760942697525024,0.0114138126373291,0.0153242945671082,0.019318699836731,0.023017406463623,0.0267295241355896,0.0500000007450581,0.129800006747246,0.5,0.0302598476409912,0.0333763360977173,0.0371780395507813,0.0399152636528015,0.0425713062286377,0.0456570386886597,0.0489232540130615,0.0519936680793762,0.0547681450843811,0.0574559569358826,0.0598379969596863,0.0622217655181885,0.0644819736480713,0.0666905045509338,0.0687864422798157],
       [0.00682878494262695,0.00125795602798462,0,0.00104051828384399,0.000818967819213867,0.00258338451385498,0.00270050764083862,0.0051419734954834,0.00788742303848267,0.0108502507209778,0.0136966109275818,0.0166296362876892,0.0799980014562607,0.135000005364418,0.479999989271164,0.0194764733314514,0.0220288634300232,0.0251851081848145,0.0274832248687744,0.0297314524650574,0.0323641300201416,0.0351728200912476,0.0378321409225464,0.0402495861053467,0.0426037311553955,0.0446995496749878,0.0468052625656128,0.0488092303276062,0.0507739782333374,0.0526443719863892],
       [0.0131134390830994,0.00457346439361572,0.00104051828384399,0,1.33514404296875E-05,0.000346183776855469,0.000390052795410156,0.00156527757644653,0.00322127342224121,0.0052141547203064,0.00725489854812622,0.00944828987121582,0.0949990004301071,0.129800006747246,0.479999989271164,0.011643648147583,0.0136563181877136,0.0161929726600647,0.0180680751800537,0.0199225544929504,0.022116482257843,0.0244807004928589,0.0267393589019775,0.0288081169128418,0.0308355689048767,0.0326504111289978,0.0344828367233276,0.0362342596054077,0.0379583835601807,0.0396057367324829],
       [0.0123046040534973,0.0040963888168335,0.000818967819213867,1.33514404296875E-05,0,0.00049513578414917,0.000547230243682861,0.00186634063720703,0.0036463737487793,0.00575017929077148,0.00788313150405884,0.0101611018180847,0.0900000035762787,0.129800006747246,0.479999989271164,0.0124313235282898,0.0145062208175659,0.0171141028404236,0.0190381407737732,0.020937979221344,0.0231826305389404,0.0255983471870422,0.0279033780097961,0.0300126075744629,0.032077968120575,0.0339255332946777,0.0357896685600281,0.0375704765319824,0.0393226146697998,0.0409960150718689],
       [0.017627477645874,0.00741332769393921,0.00258338451385498,0.000346183776855469,0.00049513578414917,0,1.2516975402832E-06,0.000439941883087158,0.00145912170410156,0.00288277864456177,0.00444889068603516,0.00620514154434204,0.0949990004301071,0.125,0.479999989271164,0.0080142617225647,0.00970619916915894,0.0118735432624817,0.0134960412979126,0.0151146650314331,0.0170454978942871,0.0191426873207092,0.0211601853370667,0.023018479347229,0.0248484015464783,0.0264932513237,0.0281597971916199,0.0297579169273376,0.0313356518745422,0.0328471660614014],
       [0.0179253816604614,0.00760942697525024,0.00270050764083862,0.000390052795410156,0.000547230243682861,1.2516975402832E-06,0,0.000393450260162354,0.001373291015625,0.0027618408203125,0.0042986273765564,0.00602781772613525,0.100000001490116,0.125,0.479999989271164,0.00781303644180298,0.00948506593704224,0.0116294622421265,0.0132362246513367,0.0148403644561768,0.016754686832428,0.0188353061676025,0.0208377242088318,0.0226829051971436,0.0245004892349243,0.026134729385376,0.027790904045105,0.0293794870376587,0.0309480428695679,0.0324510931968689],
       [0.0234740376472473,0.0114138126373291,0.0051419734954834,0.00156527757644653,0.00186634063720703,0.000439941883087158,0.000393450260162354,0,0.000297248363494873,0.00107330083847046,0.00209808349609375,0.00335425138473511,0.149000003933907,0.125,0.479999989271164,0.00472074747085571,0.00604426860809326,0.00778663158416748,0.0091177225112915,0.0104643702507019,0.012090802192688,0.0138786435127258,0.015616238117218,0.0172299742698669,0.0188301801681519,0.0202769637107849,0.0217501521110535,0.0231692790985107,0.0245760083198547,0.0259285569190979],
       [0.0288642644882202,0.0153242945671082,0.00788742303848267,0.00322127342224121,0.0036463737487793,0.00145912170410156,0.001373291015625,0.000297248363494873,0,0.000241279602050781,0.000817537307739258,0.00165861845016479,0.143900007009506,0.1199000030756,0.479999989271164,0.00265669822692871,0.00367307662963867,0.00506043434143066,0.00614780187606812,0.00726628303527832,0.00863742828369141,0.0101652145385742,0.0116670727729797,0.0130747556686401,0.0144811272621155,0.0157604217529297,0.0170700550079346,0.0183376669883728,0.019599437713623,0.0208172202110291],
       [0.0341590642929077,0.019318699836731,0.0108502507209778,0.0052141547203064,0.00575017929077148,0.00288277864456177,0.0027618408203125,0.00107330083847046,0.000241279602050781,0,0.000170707702636719,0.000635743141174316,0.100000001490116,0.115000002086163,0.479999989271164,0.00129938125610352,0.00203639268875122,0.00310027599334717,0.00396525859832764,0.00487548112869263,0.00601303577423096,0.00730282068252563,0.00858873128890991,0.00980716943740845,0.0110353231430054,0.0121607184410095,0.0133197903633118,0.0144477486610413,0.0155757665634155,0.0166690945625305],
       [0.0389260053634644,0.023017406463623,0.0136966109275818,0.00725489854812622,0.00788313150405884,0.00444889068603516,0.0042986273765564,0.00209808349609375,0.000817537307739258,0.000170707702636719,0,0.000147700309753418,0.100000001490116,0.101000003516674,0.479999989271164,0.00052875280380249,0.00102931261062622,0.00181925296783447,0.00249546766281128,0.00322878360748291,0.00416785478591919,0.00525498390197754,0.00635671615600586,0.00741380453109741,0.00848984718322754,0.00948363542556763,0.010513961315155,0.0115222930908203,0.0125359296798706,0.0135226249694824],
       [0.0436087250709534,0.0267295241355896,0.0166296362876892,0.00944828987121582,0.0101611018180847,0.00620514154434204,0.00602781772613525,0.00335425138473511,0.00165861845016479,0.000635743141174316,0.000147700309753418,0,0.131600007414818,0.118100002408028,0.479999989271164,0.000117599964141846,0.000397622585296631,0.000931441783905029,0.00143122673034668,0.00199902057647705,0.00275200605392456,0.00364887714385986,0.00457775592803955,0.00548326969146729,0.00641614198684692,0.00728601217269897,0.00819504261016846,0.00909078121185303,0.00999641418457031,0.0108824372291565],
       [0.0359990000724792,0.0500000007450581,0.0799980014562607,0.0949990004301071,0.0900000035762787,0.0949990004301071,0.100000001490116,0.149000003933907,0.143900007009506,0.100000001490116,0.100000001490116,0.131600007414818,0,-0.0199970006942749,-2.23799991607666,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116,0.100000001490116],
       [0.100000001490116,0.129800006747246,0.135000005364418,0.129800006747246,0.129800006747246,0.125,0.125,0.125,0.1199000030756,0.115000002086163,0.101000003516674,0.118100002408028,-0.0199970006942749,0,-0.557200014591217,0.101000003516674,0.101000003516674,0.101000003516674,0.101000003516674,0.101000003516674,0.0786990001797676,0.101000003516674,0.101000003516674,0.101000003516674,0.101000003516674,0.101000003516674,0.101000003516674,0.101000003516674,0.101000003516674,0.101000003516674],
       [0.5,0.5,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,-2.23799991607666,-0.557200014591217,0,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164,0.479999989271164],
       [0.0479862093925476,0.0302598476409912,0.0194764733314514,0.011643648147583,0.0124313235282898,0.0080142617225647,0.00781303644180298,0.00472074747085571,0.00265669822692871,0.00129938125610352,0.00052875280380249,0.000117599964141846,0.100000001490116,0.101000003516674,0.479999989271164,0,8.27908515930176E-05,0.000387430191040039,0.000729024410247803,0.00114822387695313,0.00173419713973999,0.00246024131774902,0.00323373079299927,0.00400269031524658,0.00480669736862183,0.00556504726409912,0.00636464357376099,0.00715869665145874,0.00796681642532349,0.00876206159591675],
       [0.0517986416816711,0.0333763360977173,0.0220288634300232,0.0136563181877136,0.0145062208175659,0.00970619916915894,0.00948506593704224,0.00604426860809326,0.00367307662963867,0.00203639268875122,0.00102931261062622,0.000397622585296631,0.100000001490116,0.101000003516674,0.479999989271164,8.27908515930176E-05,0,0.00011211633682251,0.000320732593536377,0.000614821910858154,0.00106018781661987,0.00164234638214111,0.0022847056388855,0.00293850898742676,0.00363367795944214,0.00429767370223999,0.0050048828125,0.00571292638778687,0.0064384937286377,0.00715678930282593],
       [0.056393027305603,0.0371780395507813,0.0251851081848145,0.0161929726600647,0.0171141028404236,0.0118735432624817,0.0116294622421265,0.00778663158416748,0.00506043434143066,0.00310027599334717,0.00181925296783447,0.000931441783905029,0.100000001490116,0.101000003516674,0.479999989271164,0.000387430191040039,0.00011211633682251,0,5.36441802978516E-05,0.000202000141143799,0.000483274459838867,0.00089728832244873,0.00138640403747559,0.00190544128417969,0.00247335433959961,0.00302684307098389,0.00362575054168701,0.00423300266265869,0.00486189126968384,0.00548988580703735],
       [0.0596672892570496,0.0399152636528015,0.0274832248687744,0.0180680751800537,0.0190381407737732,0.0134960412979126,0.0132362246513367,0.0091177225112915,0.00614780187606812,0.00396525859832764,0.00249546766281128,0.00143122673034668,0.100000001490116,0.101000003516674,0.479999989271164,0.000729024410247803,0.000320732593536377,5.36441802978516E-05,0,4.75049018859863E-05,0.000214993953704834,0.000512540340423584,0.000895380973815918,0.00132089853286743,0.00180023908615112,0.00227713584899902,0.0028005838394165,0.00333774089813232,0.00389927625656128,0.00446438789367676],
       [0.0628201365470886,0.0425713062286377,0.0297314524650574,0.0199225544929504,0.020937979221344,0.0151146650314331,0.0148403644561768,0.0104643702507019,0.00726628303527832,0.00487548112869263,0.00322878360748291,0.00199902057647705,0.100000001490116,0.101000003516674,0.479999989271164,0.00114822387695313,0.000614821910858154,0.000202000141143799,4.75049018859863E-05,0,6.03795051574707E-05,0.0002480149269104,0.000530660152435303,0.000867962837219238,0.00126379728317261,0.00166821479797363,0.00212055444717407,0.00259149074554443,0.00308948755264282,0.00359493494033813],
       [0.066456139087677,0.0456570386886597,0.0323641300201416,0.022116482257843,0.0231826305389404,0.0170454978942871,0.016754686832428,0.012090802192688,0.00863742828369141,0.00601303577423096,0.00416785478591919,0.00275200605392456,0.100000001490116,0.0786990001797676,0.479999989271164,0.00173419713973999,0.00106018781661987,0.000483274459838867,0.000214993953704834,6.03795051574707E-05,0,6.36577606201172E-05,0.000233113765716553,0.000470638275146484,0.00077211856842041,0.00109457969665527,0.00146645307540894,0.00186252593994141,0.00228828191757202,0.00272667407989502],
       [0.0702759027481079,0.0489232540130615,0.0351728200912476,0.0244807004928589,0.0255983471870422,0.0191426873207092,0.0188353061676025,0.0138786435127258,0.0101652145385742,0.00730282068252563,0.00525498390197754,0.00364887714385986,0.100000001490116,0.101000003516674,0.479999989271164,0.00246024131774902,0.00164234638214111,0.00089728832244873,0.000512540340423584,0.0002480149269104,6.36577606201172E-05,0,5.32269477844238E-05,0.000188171863555908,0.000392615795135498,0.000630676746368408,0.000919759273529053,0.00123858451843262,0.00159013271331787,0.00195914506912231],
       [0.0738418102264404,0.0519936680793762,0.0378321409225464,0.0267393589019775,0.0279033780097961,0.0211601853370667,0.0208377242088318,0.015616238117218,0.0116670727729797,0.00858873128890991,0.00635671615600586,0.00457775592803955,0.100000001490116,0.101000003516674,0.479999989271164,0.00323373079299927,0.0022847056388855,0.00138640403747559,0.000895380973815918,0.000530660152435303,0.000233113765716553,5.32269477844238E-05,0,4.13656234741211E-05,0.000156819820404053,0.000317752361297607,0.00053095817565918,0.000779092311859131,0.00106263160705566,0.00136798620223999],
       [0.077045202255249,0.0547681450843811,0.0402495861053467,0.0288081169128418,0.0300126075744629,0.023018479347229,0.0226829051971436,0.0172299742698669,0.0130747556686401,0.00980716943740845,0.00741380453109741,0.00548326969146729,0.100000001490116,0.101000003516674,0.479999989271164,0.00400269031524658,0.00293850898742676,0.00190544128417969,0.00132089853286743,0.000867962837219238,0.000470638275146484,0.000188171863555908,4.13656234741211E-05,0,3.71932983398438E-05,0.000129938125610352,0.000276148319244385,0.0004616379737854,0.000685214996337891,0.000934183597564697],
       [0.0801324844360352,0.0574559569358826,0.0426037311553955,0.0308355689048767,0.032077968120575,0.0248484015464783,0.0245004892349243,0.0188301801681519,0.0144811272621155,0.0110353231430054,0.00848984718322754,0.00641614198684692,0.100000001490116,0.101000003516674,0.479999989271164,0.00480669736862183,0.00363367795944214,0.00247335433959961,0.00180023908615112,0.00126379728317261,0.00077211856842041,0.000392615795135498,0.000156819820404053,3.71932983398438E-05,0,2.81333923339844E-05,0.0001106858253479,0.000236928462982178,0.000403285026550293,0.000598907470703125],
       [0.0828560590744019,0.0598379969596863,0.0446995496749878,0.0326504111289978,0.0339255332946777,0.0264932513237,0.026134729385376,0.0202769637107849,0.0157604217529297,0.0121607184410095,0.00948363542556763,0.00728601217269897,0.100000001490116,0.101000003516674,0.479999989271164,0.00556504726409912,0.00429767370223999,0.00302684307098389,0.00227713584899902,0.00166821479797363,0.00109457969665527,0.000630676746368408,0.000317752361297607,0.000129938125610352,2.81333923339844E-05,0,2.71797180175781E-05,0.000101804733276367,0.000218510627746582,0.000367641448974609],
       [0.085570752620697,0.0622217655181885,0.0468052625656128,0.0344828367233276,0.0357896685600281,0.0281597971916199,0.027790904045105,0.0217501521110535,0.0170700550079346,0.0133197903633118,0.010513961315155,0.00819504261016846,0.100000001490116,0.101000003516674,0.479999989271164,0.00636464357376099,0.0050048828125,0.00362575054168701,0.0028005838394165,0.00212055444717407,0.00146645307540894,0.000919759273529053,0.00053095817565918,0.000276148319244385,0.0001106858253479,2.71797180175781E-05,0,2.37226486206055E-05,9.14335250854492E-05,0.000194787979125977],
       [0.0881350636482239,0.0644819736480713,0.0488092303276062,0.0362342596054077,0.0375704765319824,0.0297579169273376,0.0293794870376587,0.0231692790985107,0.0183376669883728,0.0144477486610413,0.0115222930908203,0.00909078121185303,0.100000001490116,0.101000003516674,0.479999989271164,0.00715869665145874,0.00571292638778687,0.00423300266265869,0.00333774089813232,0.00259149074554443,0.00186252593994141,0.00123858451843262,0.000779092311859131,0.0004616379737854,0.000236928462982178,0.000101804733276367,2.37226486206055E-05,0,2.20537185668945E-05,8.26120376586914E-05],
       [0.0906322002410889,0.0666905045509338,0.0507739782333374,0.0379583835601807,0.0393226146697998,0.0313356518745422,0.0309480428695679,0.0245760083198547,0.019599437713623,0.0155757665634155,0.0125359296798706,0.00999641418457031,0.100000001490116,0.101000003516674,0.479999989271164,0.00796681642532349,0.0064384937286377,0.00486189126968384,0.00389927625656128,0.00308948755264282,0.00228828191757202,0.00159013271331787,0.00106263160705566,0.000685214996337891,0.000403285026550293,0.000218510627746582,9.14335250854492E-05,2.20537185668945E-05,0,1.93119049072266E-05],
       [0.0929945111274719,0.0687864422798157,0.0526443719863892,0.0396057367324829,0.0409960150718689,0.0328471660614014,0.0324510931968689,0.0259285569190979,0.0208172202110291,0.0166690945625305,0.0135226249694824,0.0108824372291565,0.100000001490116,0.101000003516674,0.479999989271164,0.00876206159591675,0.00715678930282593,0.00548988580703735,0.00446438789367676,0.00359493494033813,0.00272667407989502,0.00195914506912231,0.00136798620223999,0.000934183597564697,0.000598907470703125,0.000367641448974609,0.000194787979125977,8.26120376586914E-05,1.93119049072266E-05,0]]

Aij = array(Aij)

# Aij[:,:] = 0.

Aij[-2,:] = 0.5
Aij[:,-2] = 0.5
Aij[-2,-2] = 0
Aij[0,-2] = 0.4850
Aij[-2,0] = 0.4850
Aij[-3,-2]=-2.23799991607666
Aij[-2,-3]=-2.23799991607666

Aij[-1,:] = 0.09
Aij[:,-1] = 0.09
Aij[-1,0:8] = 0.12
Aij[0:8,-1] = 0.12
Aij[-1,-1] = 0

Aij[-1,-2] = 0.1896
Aij[-2,-1] = 0.1896
Aij[-1,-3] = -1.99970006942749e-002
Aij[-3,-1] = -1.99970006942749e-002

kp = [[0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.379640000000000, 1.48503000000000, -0.164420000000000, 0.016666000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000],
      [0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000]]

# kp = [[0.374640000000000, 1.54226000000000, -0.269920000000000, 0.000000000000000]]*30

# CH4	  C2H6	  C3H8	  iC4H10  nC4H10  iC5H12  nC5H12  nC6H14  nC7H16  nC8H18	
# nC9H20  nC10H22 nC11H24 nC12H26 nC13H28 nC14H30 nC15H32 nC16H34 nC17H36	
# nC18H38 nC19H40 nC20H42 nC21H44 nC22H46 nC23H48 nC24H50 nC25H52 N2 H2O CO2

list_names  = ["CH4",	  "C2H6",	  "C3H8",	  "iC4H10",  "nC4H10",  "iC5H12",  "nC5H12",  "nC6H14",  "nC7H16",  "nC8H18",	
               "nC9H20",  "nC10H22", "nC11H24", "nC12H26", "nC13H28", "nC14H30", "nC15H32", "nC16H34", "nC17H36",	
               "nC18H38", "nC19H40", "nC20H42", "nC21H44", "nC22H46", "nC23H48", "nC24H50", "nC25H52", "N2", "H2O", "CO2"]


# Definir a matriz como uma string para facilitar a entrada
Cps = """
4.568 8.975 3.631 -3.407 1.091
4.178 -4.427 5.660 -6.651 2.487
3.847 5.131 6.011 -7.893 3.079
3.351 17.883 5.477 -8.099 3.243
5.547 5.536 8.057 -10.571 4.134
1.959 38.191 2.434 -5.175 2.165
7.554 -0.368 11.846 -14.939 5.753
8.831 -0.166 14.302 -18.314 7.124 
9.634 4.156 15.494 -20.066 7.770
10.824 4.983 17.751 -23.137 8.980
12.152 4.575 20.416 -26.777 10.465
13.467 4.139 23.127 -30.477 11.970
-4.671 93.882 -4.334 -1.331 1.317
17.229 -7.242 31.922 -42.322 17.022
18.546 -7.636 34.604 -45.978 18.509
18.375 6.585 32.307 -42.663 16.590
21.180 8.424 39.969 -53.290 21.482
39.747 -206.152 114.814 -155.548 67.534
23.813 -9.210 45.333 -60.601 24.455
25.130 -9.603 48.015 -64.256 25.942
26.447 -9.998 50.697 -67.912 27.428
27.764 10.389 53.379 -71.567 28.914
10.1411905 102.103917 -2.51987359 0 0
10.8628781 106.959006 -2.64166668 0 0
11.5679935 111.814827 -2.76380954 0 0
12.3611837 116.667558 -2.88530122 0 0
13.0897174 121.540105 -3.00751740 0 0
3.539 -0.261 0.007 0.157 -0.099
4.395 -4.186 1.405 -1.564 0.632
3.259 1.356 1.502 -2.374 1.056
"""

Cp_matrix = [list(map(float, linha.split())) for linha in Cps.strip().split('\n')]


def cp_ig_fun_pure(par,T):
    return R*(par[0] + par[1]*T*1e-3 + par[2]*T**2*1e-5 + par[3]*T**3*1e-8 + par[4]*T**4*1e-11)

def enthalpy_ig_fun_pure(par,T):
    return R*(par[0]*T + par[1]*T**2/2*1e-3 + par[2]*T**3/3*1e-5 + par[3]*T**4/4*1e-8 + par[4]*T**5/5*1e-11)

def int_h_ig_RT2_dT_fun_pure(par,T):
    return par[0]*log(T) + par[1]*T/2*1e-3 + par[2]*T**2/6*1e-5 + par[3]*T**3/12*1e-8 + par[4]*T**4/20*1e-11


def entropy_ig_fun_pure(par,T):
    return  R*(par[0]*log(T) + par[1]*T*1e-3 + par[2]*T**2/2*1e-5 + par[3]*T**3/3*1e-8 + par[4]*T**4/4*1e-11)

def pvap_fun_pure(par,T):
    return exp(par[0] + par[1]/(T+par[2]) + par[3]*log(T) + par[4]*T**par[5])

def kappa_fun(par,w):
    return par[0] + par[1]*w  + par[2]*w**2 + par[3]*w**3


dipoles = [0]*len(list_names)

# name,MM,Tc,Pc,Vc,omega
list_of_species = [Species(list_names[i], critical_table[12,i], critical_table[15,i]+273.15, 
                           critical_table[16,i], critical_table[17,i], critical_table[18,i]) 
                   for i in range(len(list_names))]

Tcp = MX.sym('Tcp')
wcp = MX.sym('acentricity')

[list_of_species[i].set_cp_ig_function(
    Function('CP_i_IG',[Tcp],[cp_ig_fun_pure(Cp_matrix[i],Tcp)]),
    Function('H_i_IG',[Tcp],[enthalpy_ig_fun_pure(Cp_matrix[i],Tcp)]))
                   for i in range(len(list_of_species))]

list_int_h_ig_dt = [Function('H_i_IG_RT2_dT',[Tcp],[int_h_ig_RT2_dT_fun_pure(Cp_matrix[i],Tcp)]) \
                    for i in range(len(list_of_species))]

[list_of_species[i].set_entropy_ig_function(
    Function('S_i_IG',[Tcp],[entropy_ig_fun_pure(Cp_matrix[i],Tcp)]))
                   for i in range(len(list_of_species))]

[list_of_species[i].set_p_vap_function(
    Function('Pvap',[Tcp],[pvap_fun_pure(critical_table[6:12,i],Tcp)]))
                   for i in range(len(list_of_species))]

[list_of_species[i].set_kappa(
    Function('kappa',[wcp],[kappa_fun(kp[i],wcp)]))
                   for i in range(len(list_of_species))]

[species.evaluate_kappa() for species in list_of_species]









